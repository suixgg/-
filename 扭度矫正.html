<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æŸ±å­å¹³ç§»ä¸æ—‹è½¬è®¡ç®—å™¨</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ“</text></svg>">
  
  <!-- PWA å¿…è¦ä»£ç  -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f172a">

  <style>
    :root {
      --bg: #0f172a;
      --card: rgba(15, 23, 42, 0.85);
      --accent: #06b6d4;
      --muted: #9aa7bd;
      --green: #10b981;
      --red: #ef4444;
      --gray: #9ca3af;
    }
    body { margin:0; font-family: "SF Pro Display", system-ui, -apple-system, Roboto;
      background: linear-gradient(160deg,#0a1224 0%,#081120 100%); color:#f1f5f9;
      min-height:100vh; display:flex; align-items:center; justify-content:center; padding:20px;}
    .app { width:100%; max-width:420px; background:var(--card); border-radius:20px;
      padding:20px; backdrop-filter:blur(20px); box-shadow:0 10px 40px rgba(0,0,0,0.4);}
    h1 { text-align:center; font-size:20px; margin:0 0 6px 0; display:flex; align-items:center; justify-content:center; gap:6px; }
    .lead { text-align:center; font-size:13px; color:var(--muted); margin-bottom:18px;}
    .field { margin-bottom:14px; }
    label { font-size:13px; color:var(--muted); display:block; margin-bottom:6px;}
    input { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.05);
      background: rgba(255,255,255,0.05); color:#fff; font-size:15px; outline:none; }
    .pair-buttons { display:flex; gap:8px; margin-bottom:10px;}
    .pair-btn { flex:1; text-align:center; padding:10px 0; border-radius:8px; border:1px solid rgba(255,255,255,0.05);
      cursor:pointer; font-weight:600; background:rgba(255,255,255,0.05);}
    .pair-btn.active { background:var(--accent); color:#042028; }
    .buttons { display:flex; gap:10px; margin-top:10px;}
    button { flex:1; border:none; border-radius:10px; padding:10px; font-weight:600; cursor:pointer; font-size:15px; transition:all 0.2s ease;}
    .primary { background:linear-gradient(90deg,var(--accent),#22d3ee); color:#042028; }
    .ghost { background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.1); }
    button:active { transform:scale(0.96); }
    .results { margin-top:18px; display:grid; grid-template-columns:1fr 1fr; gap:10px;}
    .card { background:rgba(255,255,255,0.04); border-radius:12px; padding:12px; text-align:center;
      box-shadow: inset 0 0 10px rgba(255,255,255,0.02); }
    .card.full { grid-column:1/-1; }
    .val { font-size:20px; font-weight:700; margin-bottom:4px; }
    .sub { font-size:12px; color:var(--muted); }
    .dir-red { color:var(--red); }
    .dir-green { color:var(--green); }
    .dir-gray { color:var(--gray); }
    details { margin-top:16px; font-size:13px; color:var(--muted);}
    summary { cursor:pointer; color:var(--accent); font-weight:600; margin-bottom:6px;}
  </style>
</head>
<body>
  <div class="app">
    <h1>ğŸ“ æŸ±å­å¹³ç§»ä¸æ—‹è½¬è®¡ç®—å™¨</h1>
    <div class="lead">è¾“å…¥ä¸¤ç‚¹æ•°æ®è‡ªåŠ¨è®¡ç®—å¹³ç§»ä¸æ—‹è½¬ï¼ˆcmï¼‰ï¼Œé»˜è®¤ä¸¤ç‚¹è·ç¦» L=100</div>

    <div class="field pair-buttons">
      <div class="pair-btn active" id="btnNS">NSï¼ˆå—åŒ—ï¼‰</div>
      <div class="pair-btn" id="btnEW">EWï¼ˆä¸œè¥¿ï¼‰</div>
    </div>

    <div class="field">
      <label id="label1">ç‚¹1 ä½ç§»ï¼ˆcmï¼‰ï¼ˆå—ç‚¹ï¼‰</label>
      <input id="d1" type="text" placeholder="æ­£ä¸ºä¸œ/åŒ—ï¼Œè´Ÿä¸ºè¥¿/å—">
    </div>

    <div class="field">
      <label id="label2">ç‚¹2 ä½ç§»ï¼ˆcmï¼‰ï¼ˆåŒ—ç‚¹ï¼‰</label>
      <input id="d2" type="text" placeholder="æ­£ä¸ºä¸œ/åŒ—ï¼Œè´Ÿä¸ºè¥¿/å—">
    </div>

    <div class="buttons">
      <button class="primary" id="calc">è®¡ç®—</button>
      <button class="ghost" id="reset">é‡ç½®</button>
    </div>

    <div class="results">
      <div class="card full">
        <div class="val dir-gray" id="dirVal">â€”</div>
        <div class="sub">æ—‹è½¬æ–¹å‘</div>
      </div>
      <div class="card">
        <div class="val" id="tVal">â€”</div>
        <div class="sub">å¹³ç§» t (cm)</div>
      </div>
      <div class="card">
        <div class="val" id="rthetaVal">â€”</div>
        <div class="sub">æ—‹è½¬çº¿ä½ç§» rÎ¸ (cm)</div>
      </div>
      <div class="card">
        <div class="val" id="thetaDeg">â€”</div>
        <div class="sub">è§’åº¦ Î¸ (Â°)</div>
      </div>
    </div>

    <details>
      <summary>ä½¿ç”¨è¯´æ˜ï¼ˆå«é»˜è®¤ä¸¤ç‚¹è·ç¦» L=100 cmï¼‰</summary>
      1. é€‰æ‹©ç‚¹å¯¹ç±»å‹ï¼šNS ä¸ºå—åŒ—æ–¹å‘ï¼ŒEW ä¸ºä¸œè¥¿æ–¹å‘ï¼›<br>
      2. è¾“å…¥ä¸¤ç‚¹ä½ç§»ï¼ˆæ­£å€¼è¡¨ç¤ºå‘ä¸œ/åŒ—ï¼Œè´Ÿå€¼è¡¨ç¤ºå‘è¥¿/å—ï¼‰ï¼›<br>
      3. é»˜è®¤ä¸¤ç‚¹è·ç¦» L=100 cmï¼Œå¦‚éœ€ä¿®æ”¹è¯·æ‰‹åŠ¨è®¾ç½®ï¼›<br>
      4. ç‚¹å‡»â€œè®¡ç®—â€å³å¯è·å¾—å¹³ç§»ã€æ—‹è½¬é‡ä¸è§’åº¦ï¼›<br>
      5. æ—‹è½¬æ–¹å‘æ ¹æ®ç‚¹ä½å·®è‡ªåŠ¨åˆ¤æ–­ï¼Œå¹¶æ˜¾ç¤ºæ—‹è½¬é•¿åº¦ï¼›<br>
      6. æ‰€æœ‰å•ä½å‡ä¸ºå˜ç±³ï¼ˆcmï¼‰ã€‚
    </details>
  </div>

  <script>
    let pairType='NS';
    const btnNS=document.getElementById('btnNS');
    const btnEW=document.getElementById('btnEW');
    const label1=document.getElementById('label1');
    const label2=document.getElementById('label2');
    const d1=document.getElementById('d1');
    const d2=document.getElementById('d2');
    const tVal=document.getElementById('tVal');
    const rthetaVal=document.getElementById('rthetaVal');
    const thetaDeg=document.getElementById('thetaDeg');
    const dirVal=document.getElementById('dirVal');

    function updateLabels(){
      if(pairType==='NS'){
        label1.textContent='ç‚¹1 ä½ç§»ï¼ˆcmï¼‰ï¼ˆå—ç‚¹ï¼‰';
        label2.textContent='ç‚¹2 ä½ç§»ï¼ˆcmï¼‰ï¼ˆåŒ—ç‚¹ï¼‰';
      } else {
        label1.textContent='ç‚¹1 ä½ç§»ï¼ˆcmï¼‰ï¼ˆè¥¿ç‚¹ï¼‰';
        label2.textContent='ç‚¹2 ä½ç§»ï¼ˆcmï¼‰ï¼ˆä¸œç‚¹ï¼‰';
      }
    }
    btnNS.onclick=()=>{pairType='NS'; btnNS.classList.add('active'); btnEW.classList.remove('active'); updateLabels();}
    btnEW.onclick=()=>{pairType='EW'; btnEW.classList.add('active'); btnNS.classList.remove('active'); updateLabels();}
    updateLabels();

    function parseVal(v){return parseFloat(v)||0;}

    document.getElementById('calc').onclick=()=>{
      const v1=parseVal(d1.value), v2=parseVal(d2.value), Lv=100;
      const t=(v1+v2)/2;
      const r=(v1-v2)/2;
      const theta=r/(Lv/2)*180/Math.PI;
      tVal.textContent=t.toFixed(2);
      rthetaVal.textContent=Math.abs(r).toFixed(2);
      thetaDeg.textContent=theta.toFixed(3);
      let dir='æ— æ—‹è½¬', cls='dir-gray';
      if(pairType==='NS'){
        if(v1>v2){dir=`é€†æ—¶é’ˆï¼ˆæ—‹è½¬ ${Math.abs(r).toFixed(2)} cmï¼‰`; cls='dir-red';}
        else if(v1<v2){dir=`é¡ºæ—¶é’ˆï¼ˆæ—‹è½¬ ${Math.abs(r).toFixed(2)} cmï¼‰`; cls='dir-green';}
      } else {
        if(v1>v2){dir=`é¡ºæ—¶é’ˆï¼ˆæ—‹è½¬ ${Math.abs(r).toFixed(2)} cmï¼‰`; cls='dir-green';}
        else if(v1<v2){dir=`é€†æ—¶é’ˆï¼ˆæ—‹è½¬ ${Math.abs(r).toFixed(2)} cmï¼‰`; cls='dir-red';}
      }
      dirVal.textContent=dir;
      dirVal.className='val '+cls;
    };

    document.getElementById('reset').onclick=()=>{
      d1.value=''; d2.value='';
      tVal.textContent=rthetaVal.textContent=thetaDeg.textContent='â€”';
      dirVal.textContent='â€”'; dirVal.className='val dir-gray';
    };
  </script>

  <!-- PWA Service Worker æ³¨å†Œ -->
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ'))
      .catch(err => console.log('âŒ Service Worker æ³¨å†Œå¤±è´¥', err));
  }
  </script>
</body>
</html>
